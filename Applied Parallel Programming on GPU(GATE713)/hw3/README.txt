currently CUDA version of thrust implementation is wrong 